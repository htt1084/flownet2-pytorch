# INFERENCE (on MPI-Sintel) work for pretrained FlowNet2 model with batchNorm set to False
python main.py --inference --model FlowNet2 --save_flow --inference_dataset MpiSintelClean \
--inference_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training \
--resume /mnt/flownet2-pytorch/FlowNet2_checkpoint.pth.tar

# Train and validate on FlowNet2SD on MPI-Sintel
python main.py --batch_size 8 --model FlowNet2SD --loss=L1Loss --optimizer=Adam --optimizer_lr=1e-4 \
--training_dataset MpiSintelFinal --training_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training  \
--validation_dataset MpiSintelClean --validation_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training

# Train FlowNet2CSS on FlyingChairs, validate on MPI-Sintel clean
python main.py --batch_size 8 --model FlowNet2CSS --loss=L1Loss --optimizer=Adam --optimizer_lr=1e-4 \
--training_dataset FlyingChairs --training_dataset_root /mnt/flownet2-pytorch/data/FlyingChairs_release/data  \
--validation_dataset MpiSintelClean --validation_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training

# Resume training FlowNet2CSS on FlyingChairs, validate on MPI-Sintel clean
python main.py --batch_size 8 --model FlowNet2CSS --loss=L1Loss --optimizer=Adam --optimizer_lr=1e-4 \
--training_dataset FlyingChairs --training_dataset_root /mnt/flownet2-pytorch/data/FlyingChairs_release/data  \
--validation_dataset MpiSintelClean --validation_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training \
--resume work/FlowNet2CSS_train-checkpoint.pth.tar

# INFERENCE on MPI-Sintel clean for FlowNet2CSS
python main.py --inference --model FlowNet2CSS --save_flow --inference_dataset MpiSintelClean --inference_dataset_root \
/mnt/flownet2-pytorch/MPI-Sintel/training --resume work/FlowNet2CSS_model_best.pth.tar


# Train FlowNet2SD on MPI-Sintel but with different metric
python main.py --batch_size 4 --model FlowNet2SD --optimizer=Adam --optimizer_lr=1e-4 \
--loss=MultiScale --loss_norm=L1 --loss_numScales=5 --loss_startScale=4 --crop_size 256 256 \
--training_dataset MpiSintelFinal --training_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training  \
--validation_dataset MpiSintelClean --validation_dataset_root /mnt/flownet2-pytorch/MPI-Sintel/training

# INFERENCE on MPI-Sintel for selftrained FlowNet2 model with batchNorm set to True
python main.py --inference --model FlowNet2 --save_flow --inference_dataset MpiSintelClean --inference_dataset_root \ 
/mnt/data/flownet2-pytorch/MPI-Sintel/training --resume work/FlowNet2_model_best.pth.tar

